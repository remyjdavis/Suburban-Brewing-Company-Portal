<div class="card">
  <h3>Export Reports</h3>
  <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 15px;">
    <button onclick="generateCommissionPDF()" style="background: var(--sidebar); color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: 600;">
      ðŸ“„ Download Commission PDF
    </button>
    <button onclick="generateFullSalesReportPDF()" style="background: #4b5563; color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: 600;">
      ðŸ“Š Download Full Sales Audit
    </button>
  </div>
</div>

<script>
function generateCommissionPDF() {
  const comm = document.getElementById('commissionValue').innerText;
  const rate = document.getElementById('currentRate').innerText;
  const sales = document.getElementById('grossSales').innerText;
  const date = document.getElementById('current-date').textContent;

  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <html>
      <head><title>Commission Report - ${date}</title></head>
      <style>
        body { font-family: sans-serif; padding: 40px; }
        .header { border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
        .val { font-size: 24px; font-weight: bold; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
      </style>
      <body>
        <div class="header">
          <h1>Commission Statement</h1>
          <p>Suburban Brewing Co. | ${date}</p>
        </div>
        <p><strong>Total Monthly Sales:</strong> ${sales}</p>
        <p><strong>Calculated Tiered Rate:</strong> ${rate}</p>
        <p class="val">Total Commission Due: ${comm}</p>
        <hr>
        <h3>Invoice Audit Trail</h3>
        ${document.getElementById('invoiceList').parentElement.outerHTML}
      </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.print();
}

async function generateFullSalesReportPDF() {
  // This will fetch ALL data including payment types from the server
  const response = await fetch(`${API_URL}?action=getFullAuditData`, { redirect: "follow" });
  const data = await response.json();
  
  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <html>
      <head><title>Monthly Sales Audit</title></head>
      <style>
        body { font-family: sans-serif; font-size: 12px; padding: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #000; padding: 5px; text-align: left; }
        th { background: #eee; }
      </style>
      <body>
        <h2>Suburban Brewing Co. - Full Sales Audit</h2>
        <table>
          <thead>
            <tr>
              <th>Date</th><th>Inv #</th><th>Customer</th><th>Amount</th><th>Status</th><th>Payment Type</th>
            </tr>
          </thead>
          <tbody>
            ${data.map(inv => `
              <tr>
                <td>${inv.date}</td>
                <td>${inv.number}</td>
                <td>${inv.customer}</td>
                <td>$${inv.amount.toFixed(2)}</td>
                <td>${inv.status}</td>
                <td>${inv.paymentType}</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
      </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.print();
}
</script>
