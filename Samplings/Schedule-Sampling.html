<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Schedule Sampling | Suburban Brewing Co.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
        body { margin: 0; background: #f4f6f8; color: #1f2937; }
        .layout { display: flex; min-height: 100vh; }
        
        /* ================= SIDEBAR ================= */
        .sidebar { width: 240px; background: #1f2937; color: #fff; padding: 20px 0; }
        .sidebar h2 { margin: 0 20px 20px; font-size: 18px; }
        .nav-link { display: block; padding: 12px 20px; color: #d1d5db; text-decoration: none; }
        .nav-link.active { background: #374151; color: #fff; border-left: 4px solid #2563eb; }
        
        /* ================= MAIN CONTENT ================= */
        .main { flex: 1; padding: 24px; }
        .header { margin-bottom: 24px; }
        .card { background: #fff; padding: 24px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); max-width: 600px; }
        
        label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 14px; color: #4b5563; }
        input, select, textarea { 
            width: 100%; padding: 10px; margin-bottom: 20px; 
            border: 1px solid #d1d5db; border-radius: 6px; font-size: 16px; 
        }
        
        .btn-group { display: flex; gap: 12px; }
        button { 
            flex: 1; padding: 12px; border-radius: 6px; border: none; 
            font-weight: 600; cursor: pointer; transition: 0.2s; 
        }
        .btn-save { background: #2563eb; color: #fff; }
        .btn-save:hover { background: #1d4ed8; }
        .btn-cancel { background: #f3f4f6; color: #4b5563; }

        .sync-note { 
            margin-top: 15px; font-size: 12px; color: #6b7280; 
            display: flex; align-items: center; gap: 5px;
        }
    </style>
</head>
<body>

<div class="layout">
    <aside class="sidebar">
        <h2>Suburban Brewing</h2>
        <a class="nav-link" href="../sales/invoices.html">Invoices</a>
        <a class="nav-link" href="../sales/deliveries.html">Deliveries</a>
        <a class="nav-link active" href="schedule-sampling.html">Schedule Sampling</a>
        <a class="nav-link" href="sampling-report.html">Sampling Report</a>
        <a class="nav-link" href="sampling-calendar.html">Calendar View</a>
        <a class="nav-link" href="../inventory/brewery-inventory.html">Inventory</a>
    </aside>

    <main class="main">
        <div class="header">
            <h1>Schedule New Sampling</h1>
            <p>Book a slot and sync it with your Apple Calendar.</p>
        </div>

        <div class="card">
            <form id="scheduleForm">
                <label for="eventDate">Date of Sampling</label>
                <input type="date" id="eventDate" required>

                <label for="eventTime">Start Time</label>
                <input type="time" id="eventTime" required>

                <label for="accountName">Account / Lead Name</label>
                <input type="text" id="accountName" placeholder="e.g. PJ's Pub" required>

                <label for="location">Location Address</label>
                <input type="text" id="location" placeholder="Street, City, Zip">

                <label for="products">Expected Products to Sample</label>
                <input type="text" id="products" placeholder="e.g. 50/50 IPA, Belgian Wit">

                <label for="notes">Notes for Visit</label>
                <textarea id="notes" rows="3" placeholder="Talk to GM about seasonal lines..."></textarea>

                <div class="btn-group">
                    <button type="button" class="btn-cancel" onclick="window.history.back()">Cancel</button>
                    <button type="submit" class="btn-save">Confirm & Sync Calendar</button>
                </div>

                <div class="sync-note">
                    ðŸ“… Saving this will automatically push to your iCloud/Apple Calendar.
                </div>
            </form>
        </div>
    </main>
</div>

<script>
    const API_URL = "https://script.google.com/macros/s/AKfycbzWSIh-msRqg_tqU3l2jGXlxRIgxZKE-tcVNYadAGb9jKtDV_VZuLS-6hxkMkqdaJoj/exec";

    document.getElementById('scheduleForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const payload = {
            action: "scheduleSampling",
            date: document.getElementById('eventDate').value,
            time: document.getElementById('eventTime').value,
            account: document.getElementById('accountName').value,
            location: document.getElementById('location').value,
            products: document.getElementById('products').value,
            notes: document.getElementById('notes').value
        };

        try {
            const response = await fetch(API_URL, {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams(payload)
            });
            const result = await response.json();
            
            if(result.success) {
                alert("Sampling Scheduled and Calendar Invite Sent!");
                document.getElementById('scheduleForm').reset();
            }
        } catch (error) {
            console.error("Error:", error);
            alert("Failed to sync. Please check connection.");
        }
    });
</script>

</body>
</html>
