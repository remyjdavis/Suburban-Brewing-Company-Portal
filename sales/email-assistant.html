<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sales Assistant | Suburban Brewing Co.</title>
  
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    /* --- SHARED THEME VARIABLES --- */
    :root {
      --bg: #f4f6f8;
      --sidebar: #0f172a;
      --accent: #2563eb;
      --text: #1f2937;
      --text-muted: #6b7280;
      --green-accent: #10b981;
    }
    
    * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; -webkit-tap-highlight-color: transparent; }
    body { margin: 0; background: var(--bg); color: var(--text); display: flex; min-height: 100vh; }
    
    /* --- SIDEBAR STYLES --- */
    .sidebar { width: 260px; background: var(--sidebar); color: #fff; padding: 24px 0; flex-shrink: 0; position: fixed; height: 100vh; overflow-y: auto; z-index: 1000; }
    .sidebar h2 { margin: 0 24px 32px; font-size: 20px; font-weight: 800; color: #fff; }

    .nav-section-header { font-size: 11px; text-transform: uppercase; color: #9ca3af; margin: 18px 24px 8px; font-weight: 700; cursor: pointer; display: flex; justify-content: space-between; }
    .nav-section-header:hover { color: #fff; }
    
    .collapsible-content { max-height: 2000px; overflow: hidden; transition: max-height 0.4s ease; }
    .collapsible-content.collapsed { max-height: 0; }
    
    .nav-link { display: block; padding: 10px 24px; color: #d1d5db; text-decoration: none; font-size: 14px; border-left: 4px solid transparent; }
    .nav-link:hover, .nav-link.active { background: #374151; color: #fff; }
    .nav-link.active { border-left-color: var(--accent); }

    /* --- MAIN CONTENT --- */
    .main { flex: 1; margin-left: 260px; display: flex; flex-direction: column; }
    .topbar { background: #fff; border-bottom: 1px solid #e5e7eb; padding: 16px 24px; display: flex; justify-content: space-between; align-items: center; }
    .content { padding: 30px; flex-grow: 1; }

    /* --- ASSISTANT GRID --- */
    .assistant-grid {
        display: grid;
        grid-template-columns: 350px 1fr;
        gap: 30px;
        height: calc(100vh - 140px);
    }

    .panel {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        padding: 25px;
        display: flex;
        flex-direction: column;
    }
    
    .panel h3 { margin: 0 0 20px; padding-bottom: 10px; border-bottom: 2px solid #f1f5f9; color: #1e293b; font-size: 16px; }

    /* Form Elements */
    .form-group { margin-bottom: 20px; }
    .form-label { display: block; font-weight: 700; font-size: 12px; text-transform: uppercase; color: #64748b; margin-bottom: 8px; }
    .form-select, .form-input { width: 100%; padding: 12px; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 14px; color: #334155; }
    
    /* Toggle Buttons */
    .toggle-btn {
        flex: 1; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; 
        text-align: center; cursor: pointer; background: #fff; font-weight: 600; color: #64748b;
        transition: all 0.2s ease;
    }
    .toggle-btn.active-email { border-color: var(--accent); color: var(--accent); background: #eff6ff; }
    .toggle-btn.active-sms { border-color: var(--green-accent); color: var(--green-accent); background: #f0fdf4; }
    .toggle-btn input { display: none; }

    .client-card-preview {
        background: #f8fafc; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0; margin-top: 10px; display: none;
    }
    .client-card-preview.active { display: block; animation: fadeIn 0.3s ease; }

    /* Editor */
    .email-editor-container { flex-grow: 1; display: flex; flex-direction: column; gap: 15px; }
    .email-header-field { display: flex; align-items: center; border-bottom: 1px solid #f1f5f9; padding-bottom: 10px; }
    .email-header-label { width: 80px; font-weight: 600; color: #94a3b8; }
    .email-header-value { font-weight: 500; color: #1e293b; flex-grow: 1; }
    
    .email-body-textarea {
        flex-grow: 1; width: 100%; padding: 20px;
        border: 1px solid #e2e8f0; border-radius: 8px;
        resize: none; font-family: 'Segoe UI', sans-serif; font-size: 15px; line-height: 1.6; color: #334155;
    }
    .email-body-textarea:focus { outline: 2px solid var(--accent); border-color: transparent; }

    /* Buttons */
    .btn-gen { width: 100%; padding: 12px; background: var(--accent); color: white; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; transition: 0.2s; }
    .btn-gen:hover { background: #1d4ed8; }

    .btn-send {
        padding: 12px 24px; background: var(--green-accent); color: white; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: 0.2s;
    }
    .btn-send:hover { filter: brightness(90%); }

    @keyframes fadeIn { from { opacity:0; transform: translateY(5px); } to { opacity:1; transform: translateY(0); } }
    
    @media (max-width: 1024px) {
        .sidebar { display: none; }
        .main { margin-left: 0; }
        .assistant-grid { grid-template-columns: 1fr; height: auto; }
        .email-body-textarea { min-height: 300px; }
    }
  </style>
</head>
<body>

  <aside class="sidebar">
    <h2>SUBURBAN BREWING</h2>
    
    <div class="nav-section-header" onclick="toggleGroup('grp-main', this)"><span>Main Menu</span></div>
    <div id="grp-main" class="collapsible-content">
      <a href="index.html" class="nav-link"><span>Command Center</span></a>
      <a href="sales-assistant.html" class="nav-link active"><span>Sales Assistant</span></a>
    </div>
    
    <div class="nav-section-header" onclick="toggleGroup('grp-sales', this)"><span>Sales</span></div>
    <div id="grp-sales" class="collapsible-content">
      <a href="sales/sales-opportunities.html" class="nav-link"><span>Sales Opportunities</span></a>
      <a href="sales/leads.html" class="nav-link"><span>AI Sales Leads</span></a>
      <a href="sales/deliveries.html" class="nav-link"><span>Delivery Tracking</span></a>
    </div>

    <div class="nav-section-header" onclick="toggleGroup('grp-inv', this)"><span>Inventory</span></div>
    <div id="grp-inv" class="collapsible-content">
       <a href="inventory/brewery.html" class="nav-link"><span>Master Inventory</span></a>
    </div>
  </aside>

  <main class="main">
    <header class="topbar">
      <h1>Sales Follow-Up Assistant</h1>
      <span style="font-size: 13px; color: var(--text-muted); display:none; @media(min-width:768px){display:inline;}">
        Drafts use professional, pre-approved templates.
      </span>
    </header>

    <section class="content">
      <div class="assistant-grid">
        
        <div class="panel">
            <h3>1. Drafting Options</h3>
            
            <div class="form-group">
                <label class="form-label">Communication Channel</label>
                <div style="display: flex; gap: 10px;">
                    <label class="toggle-btn active-email" id="btn-email">
                        <input type="radio" name="channel" value="email" checked onclick="toggleChannel('email')"> 
                        üìß Email
                    </label>
                    <label class="toggle-btn" id="btn-sms">
                        <input type="radio" name="channel" value="sms" onclick="toggleChannel('sms')"> 
                        üí¨ Text
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Select Client</label>
                <select class="form-select" id="clientSelect" onchange="showClientInfo()">
                    <option value="">-- Choose Contact --</option>
                    <option value="brickhouse">The Brickhouse (Due Now)</option>
                    <option value="taproom24">Taproom 24</option>
                    <option value="pizzaco">City Pizza Co. (Lead)</option>
                    <option value="pa_dist">PA Wholesalers Inc.</option>
                </select>
                
                <div id="clientInfo" class="client-card-preview">
                    <div id="contactNameDisplay" style="font-weight: 700;">--</div>
                    <div style="font-size: 13px; color: #64748b;">Phone: <span id="contactPhoneDisplay">--</span></div>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Select Goal / Template</label>
                <select class="form-select" id="templateSelect">
                    <option value="">-- What is the goal? --</option>
                    <option value="inventory">Weekly Inventory Check (Soft)</option>
                    <option value="seasonal">New Seasonal Release (Hype)</option>
                    <option value="sample">Post-Sample Follow Up</option>
                    <option value="event">Tap Takeover / Event Pitch</option>
                    <option value="invoice">Gentle Invoice Reminder</option>
                    <option value="winback">"Miss You" / Re-Engagement</option>
                    <option disabled>--- Special Scenarios ---</option>
                    <option value="manager_missed">Missed You (Spoke to Bartender)</option>
                    <option value="wholesaler_restock">Wholesaler: Restock Check</option>
                </select>
            </div>

            <button class="btn-gen" onclick="generateDraft()">Generate Draft ‚ú®</button>
        </div>

        <div class="panel">
            <h3>2. Review & Customize</h3>
            
            <div class="email-editor-container">
                <div class="email-header-field" id="row-to">
                    <span class="email-header-label">To:</span>
                    <span class="email-header-value" id="previewTo">...</span>
                </div>
                <div class="email-header-field" id="row-subject">
                    <span class="email-header-label">Subject:</span>
                    <input type="text" class="form-input" id="previewSubject" placeholder="Subject..." style="border:none; padding: 0; font-weight: 500; font-size:16px;">
                </div>
                
                <textarea class="email-body-textarea" id="previewBody" placeholder="Select a channel, client, and goal, then click 'Generate Draft'."></textarea>

                <div style="display: flex; justify-content: flex-end; align-items: center; gap: 15px;">
                    <div style="font-size: 12px; color: #64748b; font-style: italic;">Sending updates "Last Contact Date"</div>
                    <button class="btn-send" id="mainSendBtn" onclick="sendAction()">
                        <span>üöÄ Send Email</span>
                    </button>
                </div>
            </div>
        </div>

      </div>
    </section>
  </main>

  <script>
    // --- SIDEBAR TOGGLE ---
    function toggleGroup(contentId, headerEl) {
       const content = document.getElementById(contentId);
       if(content) content.classList.toggle('collapsed');
    }

    // --- DATA ---
    const clients = {
        'brickhouse': { contact: 'Sarah Johnson', email: 'sarah@brickhouse.com', phone: '610-555-0101' },
        'taproom24': { contact: 'Mike Davis', email: 'mike@taproom24.com', phone: '484-555-0102' },
        'pizzaco': { contact: 'Manager', email: 'info@citypizzaco.com', phone: '610-555-0999' },
        'pa_dist': { contact: 'Jim (Buyer)', email: 'orders@padist.com', phone: '215-555-8888' }
    };

    let currentMode = 'email';

    // --- UI LOGIC ---
    function toggleChannel(mode) {
        currentMode = mode;
        
        // Visuals
        const btnEmail = document.getElementById('btn-email');
        const btnSms = document.getElementById('btn-sms');
        
        if (mode === 'email') {
            btnEmail.className = 'toggle-btn active-email';
            btnSms.className = 'toggle-btn';
            document.getElementById('row-subject').style.display = 'flex';
            document.getElementById('mainSendBtn').style.background = 'var(--accent)';
            document.getElementById('mainSendBtn').innerHTML = '<span>üöÄ Send Email</span>';
        } else {
            btnEmail.className = 'toggle-btn';
            btnSms.className = 'toggle-btn active-sms';
            document.getElementById('row-subject').style.display = 'none';
            document.getElementById('mainSendBtn').style.background = 'var(--green-accent)';
            document.getElementById('mainSendBtn').innerHTML = '<span>üí¨ Open Messages</span>';
        }
        
        // Refresh info if client selected
        showClientInfo();
    }

    function showClientInfo() {
        const val = document.getElementById('clientSelect').value;
        const infoBox = document.getElementById('clientInfo');
        const nameDisplay = document.getElementById('contactNameDisplay');
        const phoneDisplay = document.getElementById('contactPhoneDisplay');
        const toDisplay = document.getElementById('previewTo');

        if (val && clients[val]) {
            infoBox.classList.add('active');
            nameDisplay.innerText = "Contact: " + clients[val].contact;
            phoneDisplay.innerText = clients[val].phone;
            
            // Update "To" field based on mode
            toDisplay.innerText = (currentMode === 'email') ? clients[val].email : clients[val].phone;
        } else {
            infoBox.classList.remove('active');
            toDisplay.innerText = "...";
        }
    }

    // --- GENERATION ENGINE ---
    function generateDraft() {
        const clientKey = document.getElementById('clientSelect').value;
        const template = document.getElementById('templateSelect').value;
        
        if(!clientKey) { Swal.fire('Error', 'Please select a client first.', 'warning'); return; }

        const contactName = clients[clientKey].contact.split(' ')[0]; 
        let subject = "";
        let body = "";

        if (currentMode === 'email') {
            // --- EMAIL TEMPLATES ---
            switch (template) {
                case 'inventory':
                    subject = `Quick stock check: Suburban Brewing`;
                    body = `Hi ${contactName},\n\nHope the weekend rush treated you well!\n\nI'm looking at my delivery route for later this week and wanted to check your inventory levels. Are you running low on IPA or need to rotate any handles soon?\n\nLet me know by tomorrow morning and I can get you on the truck.\n\nCheers,\nRemy`;
                    break;
                case 'seasonal':
                    subject = `First Dibs: [Seasonal Name] is ready üç∫`;
                    body = `Hi ${contactName},\n\nI wanted to give you a heads up before I blast this to the wider list.\n\nOur new [Seasonal Name] (ABV %) is finally kegged. It's tasting incredible‚Äî[insert flavor profile].\n\nGiven the vibe at your place, I think this would move fast on your patio tap.\n\nAllocations are tight on this one‚Äîwant me to reserve a 1/2 bbl for you?\n\nBest,\nRemy`;
                    break;
                case 'sample':
                    subject = `Feedback on those samples?`;
                    body = `Hey ${contactName},\n\nJust following up on the samples I dropped off earlier this week. Did you or the bar manager get a chance to crack them open?\n\nI'd love to hear your thoughts, specifically on the [Beer Name]. I think it fits that gap in your current tap list we talked about.\n\nTalk soon,\nRemy`;
                    break;
                case 'event':
                    subject = `Event Idea: Tap Takeover`;
                    body = `Hi ${contactName},\n\nI've been thinking about ways we can help drive some extra foot traffic to your place next month.\n\nWhat if we set up a "Meet the Brewer" or Tap Takeover night? We can bring some limited-release swag, maybe a firkin of something special, and promote it on our social media channels to get our crowd through your doors.\n\nDo you have a slow Tuesday or Wednesday coming up that needs a boost?\n\nLet me know,\nRemy`;
                    break;
                case 'invoice':
                    subject = `Invoice #1234 Reminder - Suburban Brewing`;
                    body = `Hi ${contactName},\n\nHope you're having a good week.\n\nThis is just a friendly bump on Invoice #1234 (attached). It looks like it's just past due.\n\nIf you've already sent the check, please disregard! Otherwise, if you need me to resend the PDF, just let me know.\n\nThanks,\nRemy`;
                    break;
                case 'winback':
                    subject = `Long time no see!`;
                    body = `Hey ${contactName},\n\nI was just looking through my logs and realized it's been a little while since we had Suburban on tap.\n\nWe've actually adjusted our pricing on [Core Beer] and released a few new hazies that I think your regulars would love.\n\nI'll be in your area on Thursday‚Äîmind if I swing by for 5 minutes to drop off some fresh liquid?\n\nCheers,\nRemy`;
                    break;
                case 'manager_missed':
                    subject = `Sorry I missed you today`;
                    body = `Hi ${contactName},\n\nI stopped by earlier today to drop off some info on our new releases, but I know you were out/busy.\n\n[Bartender Name] behind the bar took great care of me‚ÄîI left a few samples with them for you to try.\n\nI'd love to connect next week. Is Tuesday morning usually good for you?\n\nBest,\nRemy`;
                    break;
                case 'wholesaler_restock':
                    subject = `Suburban Brewing | Inventory & Next PO`;
                    body = `Hi ${contactName},\n\nHope the team is having a good week.\n\nI'm looking at our production schedule and seeing inventory moving quickly on [Core Brand]. I wanted to check your current warehouse levels to ensure we don't gap the market.\n\nDo you need to cut a PO this week to top off for the weekend?\n\nAlso, are you hearing any specific feedback from the reps on the street regarding the new seasonal?\n\nThanks,\nRemy`;
                    break;
                default:
                    body = "Please select a template goal.";
            }
        } else {
            // --- SMS TEMPLATES (Short) ---
            switch (template) {
                case 'inventory':
                    body = `Hey ${contactName}, Remy from Suburban here. Route planning for the week‚Äîyou good on stock or need me to add anything to the truck?`;
                    break;
                case 'seasonal':
                    body = `Hi ${contactName}, just a heads up: our new [Seasonal Name] is kegged and tasting awesome. Think it would kill it on your patio. Want me to save you a keg? -Remy`;
                    break;
                case 'sample':
                    body = `Hey ${contactName}, did you get a chance to try those samples I dropped off? I'd love to get your thoughts on the [Beer Name] when you have a sec.`;
                    break;
                case 'event':
                    body = `Hi ${contactName}, I have a fun idea for a Tap Takeover next month to drive some traffic your way. You around for a 5-min call tomorrow?`;
                    break;
                case 'invoice':
                    body = `Hey ${contactName}, friendly nudge on Inv #1234. I think it might have slipped through the cracks. Let me know if you need me to resend the PDF! -Remy`;
                    break;
                case 'winback':
                    body = `Hey ${contactName}, long time no see! We have some new hazies I think your crowd would love. Can I swing by Thursday with some samples? -Remy`;
                    break;
                case 'manager_missed':
                    body = `Hey ${contactName}, sorry I missed you today! Left some fresh samples with the bartender for you. Let me know if you like them! -Remy (Suburban Brewing)`;
                    break;
                case 'wholesaler_restock':
                    body = `Hi ${contactName}, checking Wholesaler inventory. Seeing [Core Brand] moving fast‚Äîdo we need to cut a PO to keep you stocked for the weekend?`;
                    break;
                default:
                    body = "Please select a goal.";
            }
        }

        document.getElementById('previewSubject').value = subject;
        document.getElementById('previewBody').value = body;
    }

    // --- SEND ACTION ---
    function sendAction() {
        const clientKey = document.getElementById('clientSelect').value;
        const body = document.getElementById('previewBody').value;
        
        if(!clientKey) { Swal.fire('Missing Info', 'Select a client first.', 'error'); return; }
        if(body.length < 5) { Swal.fire('Empty Draft', 'Generate a draft first.', 'error'); return; }

        if (currentMode === 'sms') {
            // Open Native SMS App
            const phone = clients[clientKey].phone.replace(/\D/g,''); // Strip non-numbers
            const smsLink = `sms:${phone}?&body=${encodeURIComponent(body)}`;
            window.location.href = smsLink;
        } else {
            // Simulate Email Send
            Swal.fire({
                title: 'Sent!',
                text: 'Email sent successfully via Gmail API.',
                icon: 'success',
                timer: 2000,
                showConfirmButton: false
            });
        }
    }
  </script>
</body>
</html>
