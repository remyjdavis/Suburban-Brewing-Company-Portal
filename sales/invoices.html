<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Invoices | Suburban Brewing Company</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- ======================================================
       GLOBAL STYLES
  ====================================================== -->
  <style>
    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    body {
      margin: 0;
      background: #f4f6f8;
      color: #1f2937;
    }

    .layout {
      display: flex;
      min-height: 100vh;
    }

    /* ======================================================
       SIDEBAR
    ====================================================== */
    .sidebar {
      width: 240px;
      background: #1f2937;
      color: #ffffff;
      padding: 20px 0;
    }

    .sidebar h2 {
      margin: 0 20px 20px;
      font-size: 18px;
    }

    .nav-section-title {
      font-size: 12px;
      text-transform: uppercase;
      opacity: 0.6;
      margin: 16px 20px 8px;
    }

    .nav-link {
      display: block;
      padding: 10px 20px;
      color: #d1d5db;
      text-decoration: none;
    }

    .nav-link.active,
    .nav-link:hover {
      background: #374151;
      color: #fff;
    }

    /* ======================================================
       MAIN LAYOUT
    ====================================================== */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .topbar {
      background: #ffffff;
      border-bottom: 1px solid #e5e7eb;
      padding: 16px 24px;
    }

    .content {
      padding: 24px;
    }

    .section {
      background: #ffffff;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 24px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }

    h2 {
      margin-top: 0;
      font-size: 16px;
    }

    label {
      font-size: 12px;
      font-weight: 600;
    }

    input, select {
      width: 100%;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #d1d5db;
    }

    input[disabled] {
      background: #f3f4f6;
    }

    button {
      padding: 8px 14px;
      border-radius: 6px;
      border: none;
      background: #2563eb;
      color: #fff;
      cursor: pointer;
    }

    button.secondary {
      background: #6b7280;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }

    th, td {
      padding: 10px;
      border-bottom: 1px solid #e5e7eb;
      font-size: 14px;
    }

    tr.selected {
      background: #eff6ff;
    }

    /* ======================================================
       INVOICE PREVIEW PANEL
    ====================================================== */
    .preview {
      border-left: 4px solid #2563eb;
      background: #f9fafb;
      padding: 16px;
      margin-top: 12px;
    }
  </style>
</head>

<body>
<div class="layout">

<!-- ======================================================
     SIDEBAR
====================================================== -->
<aside class="sidebar">
  <h2>Suburban Brewing</h2>
  <div class="nav-section-title">Sales</div>
  <a class="nav-link active" href="invoices.html">Invoices</a>
  <a class="nav-link" href="sampling.html">Sampling</a>
  <div class="nav-section-title">Back</div>
  <a class="nav-link" href="../index.html">Dashboard</a>
</aside>

<!-- ======================================================
     MAIN
====================================================== -->
<div class="main">

<header class="topbar">
  <h1>Invoices</h1>
</header>

<section class="content">

<!-- ======================================================
     LOAD / SEARCH FORM
====================================================== -->
<div class="section">
  <h2>Find Customer Invoices</h2>

  <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px">
    <div>
      <label>Invoice #</label>
      <input id="invoiceNumber" disabled>
    </div>
    <div>
      <label>Customer Name</label>
      <input id="customerName" placeholder="Start typing customer..." onblur="loadInvoices()">
    </div>
    <div>
      <label>Date</label>
      <input type="date" id="invoiceDate" disabled>
    </div>
    <div>
      <label>Sales Type</label>
      <select id="salesType" disabled>
        <option>Retail</option>
        <option>Wholesale</option>
      </select>
    </div>
  </div>

  <div style="margin-top:16px">
    <button class="secondary" onclick="editFullInvoice()">Edit Full Invoice</button>
  </div>
</div>

<!-- ======================================================
     INVOICE HISTORY
====================================================== -->
<div class="section">
  <h2>Invoice History</h2>

  <table>
    <thead>
      <tr>
        <th>Invoice #</th>
        <th>Date</th>
        <th>Total</th>
        <th>Status</th>
        <th></th>
      </tr>
    </thead>
    <tbody id="historyBody">
      <tr><td colspan="5">Search for a customer to load invoices.</td></tr>
    </tbody>
  </table>
</div>

<!-- ======================================================
     PREVIEW PANEL
====================================================== -->
<div class="section preview" id="preview" style="display:none">
  <h2>Invoice Preview</h2>
  <div id="previewContent"></div>
</div>

</section>
</div>
</div>

<!-- ======================================================
     SCRIPT LOGIC
====================================================== -->
<script>
/* -------------------------------
   MOCK DATA (REPLACE WITH BACKEND)
-------------------------------- */
const mockInvoices = [
  { invoiceNumber:"INV-1001", customer:"Joe's Pub", date:"2025-12-20", total:220.50, status:"Paid", salesType:"Retail" },
  { invoiceNumber:"INV-1002", customer:"Joe's Pub", date:"2025-12-28", total:180.00, status:"Open", salesType:"Retail" }
];

/* -------------------------------
   LOAD INVOICES BY CUSTOMER
-------------------------------- */
function loadInvoices() {
  const name = document.getElementById("customerName").value.trim();
  const body = document.getElementById("historyBody");
  body.innerHTML = "";

  const results = mockInvoices.filter(i => i.customer.toLowerCase() === name.toLowerCase());

  if (!results.length) {
    body.innerHTML = `<tr><td colspan="5">No invoices found.</td></tr>`;
    return;
  }

  results.forEach(inv => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${inv.invoiceNumber}</td>
      <td>${inv.date}</td>
      <td>$${inv.total.toFixed(2)}</td>
      <td>${inv.status}</td>
      <td><button onclick='selectInvoice(${JSON.stringify(inv)})'>Load</button></td>
    `;
    body.appendChild(row);
  });
}

/* -------------------------------
   SELECT INVOICE
-------------------------------- */
function selectInvoice(inv) {
  document.querySelectorAll("tbody tr").forEach(r => r.classList.remove("selected"));
  event.target.closest("tr").classList.add("selected");

  invoiceNumber.value = inv.invoiceNumber;
  invoiceDate.value = inv.date;
  salesType.value = inv.salesType;

  document.getElementById("preview").style.display = "block";
  document.getElementById("previewContent").innerHTML = `
    <strong>Invoice #:</strong> ${inv.invoiceNumber}<br>
    <strong>Date:</strong> ${inv.date}<br>
    <strong>Total:</strong> $${inv.total.toFixed(2)}<br>
    <strong>Status:</strong> ${inv.status}
  `;
}

/* -------------------------------
   EDIT FULL INVOICE
-------------------------------- */
function editFullInvoice() {
  if (!invoiceNumber.value) {
    alert("Select an invoice first.");
    return;
  }
  window.location.href = `new invoices.html?invoice=${invoiceNumber.value}`;
}
</script>

</body>
</html>
