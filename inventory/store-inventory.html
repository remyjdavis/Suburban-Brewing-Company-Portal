<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Wholesaler Inventory | Suburban Brewing Company</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
        body { margin: 0; background: #f4f6f8; color: #1f2937; }
        .layout { display: flex; min-height: 100vh; }
        
        /* Sidebar */
        .sidebar { width: 240px; background: #1f2937; color: #fff; padding: 20px 0; }
        .sidebar h2 { margin: 0 20px 20px; font-size: 18px; }
        .nav-link { display: block; padding: 10px 20px; color: #d1d5db; text-decoration: none; }
        .nav-link.active { background: #374151; color: #fff; border-left: 4px solid #2563eb; }

        /* Main */
        .main { flex: 1; display: flex; flex-direction: column; }
        .topbar { background: #fff; border-bottom: 1px solid #e5e7eb; padding: 16px 24px; display: flex; justify-content: space-between; align-items: center;}
        .content { padding: 24px; }
        
        /* Wholesaler Cards */
        .wholesaler-card { background: #fff; border-radius: 8px; border: 1px solid #e5e7eb; margin-bottom: 24px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); overflow: hidden; }
        .wholesaler-header { background: #f9fafb; padding: 15px 20px; border-bottom: 1px solid #e5e7eb; }
        .wholesaler-name { margin: 0; font-size: 18px; color: #111827; font-weight: 700; }

        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 12px 20px; background: #fff; color: #6b7280; font-size: 11px; text-transform: uppercase; border-bottom: 2px solid #f3f4f6; }
        
        .product-cell { padding: 15px 20px; vertical-align: top; width: 30%; border-right: 1px solid #f3f4f6; background: #fafafa; }
        .pkg-grid { display: grid; grid-template-columns: 1.5fr 1fr 1fr 1fr; align-items: center; padding: 10px 20px; border-bottom: 1px solid #f3f4f6; }
        .pkg-grid:last-child { border-bottom: none; }

        .qty-val { font-weight: 600; color: #2563eb; }
        .adj-btn { padding: 4px 8px; font-size: 11px; background: #fff; border: 1px solid #d1d5db; border-radius: 4px; cursor: pointer; transition: 0.2s; }
        .adj-btn:hover { background: #2563eb; color: #fff; border-color: #2563eb; }
    </style>
</head>
<body>

<div class="layout">
    <aside class="sidebar">
        <h2>Suburban Brewing</h2>
        <a class="nav-link" href="brewery-inventory.html">Brewery Inventory</a>
        <a class="nav-link active" href="wholesaler-inventory.html">Wholesaler Inventory</a>
        <a class="nav-link" href="../sales/deliveries.html">Deliveries</a>
        <a class="nav-link" href="../index.html">Dashboard</a>
    </aside>

    <div class="main">
        <header class="topbar">
            <h1>Wholesaler Distribution Inventory</h1>
            <div id="syncStatus" style="font-size: 12px; color: #059669; font-weight: 500;">‚óè System Ready</div>
        </header>

        <section class="content" id="wholesalerContainer">
            </section>
    </div>
</div>

<script>
    // Sample Data for Operational Testing
    const sampleData = [
        {
            name: "Standard Distributing",
            products: [
                {
                    name: "Suburban IPA",
                    packages: [
                        { type: "1/2 Keg", qty: 14, unit: "Kegs" },
                        { type: "1/6 Keg", qty: 22, unit: "Kegs" },
                        { type: "24/12oz Case", qty: 45, unit: "Cases" }
                    ]
                },
                {
                    name: "Here Comes Sunshine",
                    packages: [
                        { type: "1/2 Keg", qty: 5, unit: "Kegs" },
                        { type: "24/12oz Case", qty: 12, unit: "Cases" }
                    ]
                }
            ]
        },
        {
            name: "Breakthru Beverage",
            products: [
                {
                    name: "Suburban IPA",
                    packages: [
                        { type: "1/2 Keg", qty: 8, unit: "Kegs" },
                        { type: "24/12oz Case", qty: 110, unit: "Cases" }
                    ]
                },
                {
                    name: "Social Pilsner",
                    packages: [
                        { type: "1/6 Keg", qty: 15, unit: "Kegs" }
                    ]
                }
            ]
        }
    ];

    document.addEventListener("DOMContentLoaded", () => {
        renderWholesalers(sampleData);
    });

    function renderWholesalers(data) {
        const container = document.getElementById("wholesalerContainer");
        container.innerHTML = "";

        data.forEach(ws => {
            const card = document.createElement('div');
            card.className = 'wholesaler-card';
            
            let productRows = "";
            ws.products.forEach(prod => {
                let pkgContent = "";
                prod.packages.forEach(pkg => {
                    pkgContent += `
                        <div class="pkg-grid">
                            <span>${pkg.type}</span>
                            <span class="qty-val">${pkg.qty}</span>
                            <span style="color: #6b7280; font-size: 12px;">${pkg.unit}</span>
                            <button class="adj-btn" onclick="manualAdjust('${ws.name}', '${prod.name}', '${pkg.type}')">Adjust</button>
                        </div>`;
                });

                productRows += `
                    <tr>
                        <td class="product-cell"><strong>${prod.name}</strong></td>
                        <td style="padding: 0;">${pkgContent}</td>
                    </tr>`;
            });

            card.innerHTML = `
                <div class="wholesaler-header">
                    <h3 class="wholesaler-name">${ws.name}</h3>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Brand / Product</th>
                            <th>
                                <div style="display: grid; grid-template-columns: 1.5fr 1fr 1fr 1fr; padding: 0 20px;">
                                    <span>Packaging</span><span>In Warehouse</span><span>Unit</span><span>Manual Fix</span>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>${productRows}</tbody>
                </table>`;
            container.appendChild(card);
        });
    }

    function manualAdjust(wholesaler, product, type) {
        const reason = prompt(`Reason for adjusting ${product} at ${wholesaler}? (e.g., Breakage, Audit, Transfer)`);
        if (!reason) return;
        
        const newVal = prompt(`Enter new total quantity for ${type}:`);
        if (newVal !== null && !isNaN(newVal)) {
            alert(`Operational Log: Updated ${wholesaler} ${product} to ${newVal}. Reason: ${reason}`);
            // In production, this will trigger the Apps Script update
        }
    }
</script>
</body>
</html>
